---
title:  '[κ°•μ] 4μ£Όμ°¨ μ›Ή ν•΄ν‚Ή- μ›Ή ν•΄ν‚Ή κΈ°μ  νƒμƒ‰ 3'
excerpt: "week4"

categories:
  - study
  - hacking
tags: [study,virtualbox, kalilinux, hacking]

last_modified_at: 2021-07-17T08:06:00-05:00
classes: wide
---

### 8μ£Όκ°„μ ν•΄ν‚Ή μ¤ν„°λ”” λ„¤λ²μ§Έ μ‹κ°„

μ΄λ² μ‹κ°„μ—λ” μ•…μ„± νμΌμ„ μ—…λ΅λ“ν•κ³  μ‹μ¤ν… λ…λ Ήμ„ κ³µκ²©ν•λ” κΈ°μ μΈ **νμΌ μ—…λ΅λ“ κ³µκ²©**μ— λ€ν•΄ ν•™μµν•λ” μ‹κ°„μ„ κ°€μ Έλ³΄λ„λ΅ ν•κ² μµλ‹λ‹¤~! π‰

κ°•μλ¥Ό λ“£κ³  μ‹¶μΌλ©΄ μ—¬κΈ°λ΅ gogo~! => [goormedu](https://edu.goorm.io/lecture/4953/ν™”μ΄νΈν•΄μ»¤κ°€-λκΈ°-μ„ν•-8κ°€μ§€-μ›Ή-ν•΄ν‚Ή-κΈ°μ )

<hr>

### νμΌμ—…λ΅λ“ κ³µκ²©

νμΌμ΄ μ—…λ΅λ“λλ” νμ΄μ§€(κ²μ‹ν, SNS)μ— μ•…μ„±νμΌ(μ›Ήμ…€)μ„ μ—…λ΅λ“

μ£Όλ΅ **`μ›Ήμ…€`**μ΄λΌλ” μ•…μ„±νμΌμ„ μ—…λ΅λ“ν•λ”λ°, μ›Ήμ…€μ΄λ€, μ›Ήμ„ ν†µν•΄ μ‹μ¤ν… λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•  μ μλ” μ›Ήνμ΄μ§€μ΄λ‹¤.

λ‹¤μκ·Έλ¦Όμ„ λ³΄λ©΄ μ΄λ―Έμ§€λ¥Ό μ—…λ΅λ“ν•λ” νμ΄μ§€κ°€ μκ³  ν—¤μ»¤λ” μ΄λ―Έμ§€ λ€μ‹  μ›Ήμ…€μ„ μ—…λ΅λ“ν•λ‹¤. λ§μ•½ μ‚¬μ©μκ°€ μ΄λ―Έμ§€λ¥Ό μ λ€λ΅ν™•μΈν•μ§€ μ•λ”λ‹¤λ©΄ μ›Ήμ‰μ„ μ €μ¥ν•κ² λλ‹¤.

![image](https://user-images.githubusercontent.com/53431568/125901242-6899830b-1df5-49da-8742-dc9677636a88.png)

<br>
  
λ‹¤μμΌλ΅ ν•΄μ»¤κ°€ μ›Ήμ…€μ— μ ‘κ·Όν•κ² λλ©΄ μ›Ήμ…€μ΄ μ‹¤ν–‰λκ³  ν•΄μ»¤κ°€ μ›ν•λ”λ€λ΅ μ‹μ¤ν… λ…λ Ήμ–΄κ°€ μ‹¤ν–‰λλ‹¤.

![image](https://user-images.githubusercontent.com/53431568/125900890-60788a52-acb8-4644-a007-84d953fb5bac.png)

<br>

μ΄μ  μ¬λ―Έμλ” μ‹¤μµμ μ‹κ°„μ΄λ‹¤ γ…γ…

### νμΌμ—…λ΅λ“ κ³µκ²© μ‹¤μµ

λ¨Όμ € μ›Ήμ…€ νμΌμ„ μ—…λ΅λ“ν•΄λ³΄κΈ° μ„ν•΄ κ°•μ‚¬λ‹μ κΉƒν—™μ— μ¬λΌμ™€μλ” webshell.phpλ¥Ό `/root`  λ””λ ‰ν† λ¦¬μ— wgetμΌλ΅ λ‹¤μ΄λ°›μ•λ‹¤

geditμΌλ΅ μ›Ήμ…€μ½”λ“λ¥Ό μ‚΄ν΄λ³΄λ©΄.. μ‚¬μ©μκ°€ μ…λ ¥ν•κ±Έ μ‹μ¤ν… λ…λ Ήμ–΄λ΅ μ‹¤ν–‰λκ² ν•λ” μ½”λ“κ°€ μ§μ Έμλ‹¤.

![image](https://user-images.githubusercontent.com/53431568/125961030-c99dbfa7-aaca-4ffb-84f4-997e293945ec.png)

<br>

### (1) LOW λ‹¨κ³„

File upload λ©”λ‰΄μ— λ“¤μ–΄κ°€μ„ `Browse...` λ²„νΌμ„ λλ¬ λ‹¤μκ³Ό κ°™μ΄ Webshell.php νμΌμ„ μ—…λ΅λ“ ν•λ‹¤.

![image](https://user-images.githubusercontent.com/53431568/125961167-d66cc175-4c34-4054-9d50-4984f053aabf.png)

μ—…λ΅λ“ λ²„νΌμ„ λ„λ¥΄μ μ μ—…λ΅λ“ λμ—λ‹¤κ³  ν•λ‹¤. μ΄μ  μ € κ²½λ΅λ΅ κ°€λ³΄μ!

![image](https://user-images.githubusercontent.com/53431568/125961217-90beab5b-b0a1-441f-a6bd-6b8706af8107.png)

λ‹¤μκ³Ό κ°™μ΄ μ»¤λ§¨λ“ λ…λ Ήμ–΄ μ…λ ¥μ°½μ΄ μμ–΄ μ΄λ¥Ό ν†µν•΄ μ‹μ¤ν… λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•  μ μλ‹¤.

![image](https://user-images.githubusercontent.com/53431568/125961420-d2429785-581e-482e-9517-7195ec029da1.png)

```cat /etc/passwd```λ΅ μ‹¤ν—ν• κ²°κ³Ό etc/passwd λ‚΄μ©μ΄ μ¶λ ¥λλ‹¤!

μ΄λ°μ‹μΌλ΅ μ‹μ¤ν… λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•  μ μλ” νμ΄μ§€λ¥Ό **`μ›Ήμ…€`**μ΄λΌκ³  ν•λ‹¤.

![image](https://user-images.githubusercontent.com/53431568/125961523-ce7cbd11-5e7a-495d-8411-a07597b260bd.png)

<br>

### (2) Medium λ‹¨κ³„

μ•μ—μ„ ν• κ²ƒκ³Ό κ°™μ€ κ³µκ²©μ„ μ‹¤ν–‰ν•΄λ³΄μ•λ‹¤! μ΄λ²μ—λ” μ΄λ―Έμ§€κ°€ μ—…λ΅λ“κ°€ λμ§€ μ•μ•λ”λ° κ·Έ μ΄μ λ¥Ό μ•κΈ° μ„ν•΄ bursuiteλ¥Ό ν†µν•΄ μ”μ²­μ„ intercept ν•΄μ„ μ‚΄ν΄λ³΄μ!

![image](https://user-images.githubusercontent.com/53431568/125961969-9236ff7e-efea-4016-8b22-dd267779f629.png)

`intercept -> on`μΌλ΅ μ„¤μ •ν• ν›„ μ”μ²­ λ‚μ•„μ±„κΈ°!

![image](https://user-images.githubusercontent.com/53431568/125962620-4627fcbc-7fc6-412a-859f-a924069567f4.png)

μ΄ λ¶€λ¶„ λ•λ¬ΈμΈκ²ƒ κ°™λ‹¤! 

![image](https://user-images.githubusercontent.com/53431568/125962738-f322ddc8-8d4a-4034-8e98-745051981afa.png)

<br>

κ³µκ²©μ΄ λλ‚ ν™•μΈν•κΈ° μ„ν•΄ ν•λ² μ΅°μ‘ν•΄μ„ μ”μ²­μ„ λ‚ λ ¤λ΄…μ‹λ‹¤. `application/x-php` -> `image/jpg`

![image](https://user-images.githubusercontent.com/53431568/125963076-15d182e1-d62c-4468-b1b3-fc35fef5c225.png)

μ μ‹¤ν–‰μ΄ λμ—λ‹¤. λ―Έλ””μ—„ λ‹¨κ³„μ—μ„λ” νμΌ μ—…λ΅λ“ κ³µκ²© λ€μ‘μ„ μ„ν•΄ **`Content-Type λ§ ν™•μΈ`**ν•λ‹¤λ” κ²ƒμ„ μ• μ μλ‹¤.

![image](https://user-images.githubusercontent.com/53431568/125961217-90beab5b-b0a1-441f-a6bd-6b8706af8107.png)

<br>

### (3) High λ‹¨κ³„

high λ‹¨κ³„μ—μ„λ” μ–΄λ–»κ² λ€μ‘ν•λ”μ§€ μ†μ¤μ½”λ“λ¥Ό ν†µν•΄ μ•μ•„λ³΄μ

![image](https://user-images.githubusercontent.com/53431568/125964009-26907c7d-9c8f-4a17-896f-e0ed3b4fde57.png)


μ‹¤μ  νμΌλ‚΄μ©μ ν™•μ¥μλ¥Ό ν™•μΈν•κ³ , getimagesize() λΌλ” ν•¨μλ¥Ό ν†µν•΄ μ‹¤μ λ΅ νμΌμ‚¬μ΄μ¦μΈμ§€ ν™•μΈν•κ³  μλ‹¤. λ―Έλ””μ—„ λ‹¨κ³„μ—μ„ ν• κ²ƒ μ²λΌ interceptλ¥Ό ν•΄λ³΄μ. 

![μΊ΅μ²](https://user-images.githubusercontent.com/53431568/125964342-3602b7e2-3fde-4d36-99b1-16bb5420f412.JPG)

μ΄λ²μ—” μμ •ν•  λ¶€λ¶„μ΄ 2κ°€μ§€κ°€ μλ‹¤.

1. filenameμ„ **`webshell.php` -> `webshell.php.jpg`**λ΅ λ°”κΎΌλ‹¤. 
2. `<?php` κ°€ μ‹μ‘ν•κΈ° μ „μΈ νμΌ λ‚΄μ© μ•λ¶€λ¶„μ— **`GIF89a`** λΌλ” μ½”λ“λ¥Ό μ…λ ¥ν•λ‹¤. 

> π’΅ **`GIF89`** λ” gif νμΌμ ν‘μ¤€μ— μ •μλ κ°’μΌλ΅ νμΌ λ‚΄μ©μ•μ— μ…λ ¥μ„ ν•λ©΄ μ΄λ―Έμ§€ νμΌμΈ κ²ƒ μ²λΌ μ†μΌ μ μλ‹¤. 

![image](https://user-images.githubusercontent.com/53431568/125964595-e5ee45ff-425f-413c-a68e-199f2692b100.png)

κ³µκ²© μ„±κ³µ!

![image](https://user-images.githubusercontent.com/53431568/125961217-90beab5b-b0a1-441f-a6bd-6b8706af8107.png)



### νμΌμ—…λ΅λ“ κ³µκ²© λ€μ‘ π‘¨β€π«

κ²½λ΅λ΅ ν™•μΈν•΄λ³΄λ‹ νμΌμ΄λ¦„λμ΄ phpλ΅ λλ‚μ§€ μ•μ•κΈ° λ•λ¬Έμ— μ‹¤ν–‰λμ§€ μ•λ” κ²ƒμ„ λ³Ό μ μλ‹¤. 

![image](https://user-images.githubusercontent.com/53431568/125965436-21cc9f08-df44-4387-b3a3-0c39b57c11d4.png)

μ–΄λ–¤ λ°©λ²•μ΄ μμ„κΉ?!π¤”π¤”

**νμΌμΈν΄λ£¨μ Ό κ³µκ²©, νμΌ μ—…λ΅λ“, ν¨μ¤νΈλλ²„μ„¤ κ³µκ²©** μ„Έ κ°€μ§€λ΅ μ΅°ν•©ν•λ©΄ ν•  μ μλ‹¤! ν•λ² ν•΄λ³΄μ!

#### 1) DVWAμ—μ„ νμΌ μΈν΄λ£¨μ Ό λ©”λ‰΄λ΅ λ“¤μ–΄κ°€μ„ `page = file/../../../hackable/uploads/webshell.php.jpg` μ…λ ¥!

![image](https://user-images.githubusercontent.com/53431568/125965830-e6aa2290-2fc3-40e1-bbee-cf66f265e2bd.png)

securityκ°€ high λ‹¨κ³„ μƒν™©μ΄λ―€λ΅ `ν¨μ¤νΈλλ²„μ„¤ κ³µκ²©`μ„ μ΄μ©ν•΄ κ²½λ΅λ¥Ό μ§€μ •ν•΄μ•Ό ν•λ‹¤. μ›λ μ—…λ΅λ“λ νμΌμ μ„μΉκ°€ dvwa/hackable/upload μ•„λμ— μκΈ° λ•λ¬Έμ— μ΄ 3λ²μ μƒμ„ λ””λ ‰ν† λ¦¬λ΅ μ΄λ™ν•΄μ•Όν•κΈ°λ•λ¬Έμ— `../../../` λ¥Ό μ§€μ •ν•΄μ£Όλ” κ²ƒμ΄λ‹¤!!

#### 2) cmd νλΌλ―Έν„° κ°’ μ…λ ¥

κ°•μ‚¬λ‹μ΄ μ„¤μ •ν• webshell.php νμΌμ€ cmd νλΌλ―Έν„°λ¥Ό μ‹¤ν–‰ν•λ” κ²ƒμ΄λ―€λ΅ μ£Όμ†μ°½μ— λ°”λ΅ cmd νλΌλ―Έν„° κ°’μ„ λ„κ²¨μ£Όμ–΄μ•Ό ν•λ‹¤. 

λ‹¤μκ³Ό κ°™μ΄ &cmd=cat /etc/passwd μ²λΌ λ°”λ΅ λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•λ‹¤.

![image](https://user-images.githubusercontent.com/53431568/125966976-6633e015-d0c0-4f89-8509-50d68876378d.png)

μ΄λ ‡κ² μ„Έκ°€μ§€ κ³µκ²©μ„ μ΅°ν•©ν ν•΄ν‚Ήμ— μ„±κ³µν• κ²ƒμ„ λ³Ό μ μλ‹¤~ λ­”κ°€ μ‹ λ‚λ”λ°? γ…γ…γ…π¤”π¤”

<br>

μ΄μ  impossible λ‹¨κ³„λ¥Ό ν†µν• κ³µκ²© λ€μ‘μ„ μ‚΄ν΄λ³΄μ!

μ†μ¤μ½”λ“λ¥Ό μ‚΄ν΄λ³΄λ‹ μ§„μ§ μ΄λ―Έμ§€ νμΌμΈμ§€ ν™•μΈν•¨κ³Ό λ™μ‹μ— μ΄λ―Έμ§€λ¥Ό μ—…λ΅λ“ λ λ‚΄μ©μΌλ΅ λ‹¤μ‹ μƒμ„±ν•κ³  μλ‹¤! μ΄λ ‡κ² λλ©΄ λ¬΄λ¬λ§ μ΄λ―Έμ§€ νμΌμ΄ μ—…λ΅λ“ λλ” κ²ƒμ„ λ°©μ§€ν•  μ μκ²λλ‹¤.

![image](https://user-images.githubusercontent.com/53431568/125967640-c1222e6c-ff29-4559-9997-f7cc16becbc8.png)

#### λ λ‹¤λ¥Έ λ°©λ²•μ—” λ¬΄μ—μ΄ μμ„κΉ?! μ‚΄ν΄λ³΄μπ™†β€β™€οΈ

- μ—…λ΅λ“λλ” νμΌμ΄λ¦„ λλ¤ν•κ² μƒμ„±ν•΄ ν•΄μ»¤κ°€ λ‚΄κ°€ μ—…λ΅λ“ν• νμΌμ— μ ‘κ·Όν•μ§€ λ»ν•κ² ν•λ” λ°©λ²•
- μ—…λ΅λ“ λλ” μ„λ²„λ¥Ό μ›Ήμ–΄ν”λ¦¬μΌ€μ΄μ… μ„λ²„μ™€ λ¶„λ¦¬μ‹ν‚¤λ” λ°©λ²•
- μ—…λ΅λ“ ν΄λ”μ μ‹¤ν–‰κ¶ν•μ„ μ™„μ „ν μ κ±°ν•΄ νμΌ μΈν΄λ£¨μ Όκ³µκ²©μΌλ΅λ¶€ν„° μ™„μ „ν μ°¨λ‹¨ν•λ” λ°©λ²•


<br><br>
<hr>

### CAPTCHA κ³µκ²©

![image](https://user-images.githubusercontent.com/53431568/125968433-0c64f7de-f6e4-4abb-9315-28b08b0e9cba.png)

μ„μ μ΄λ―Έμ§€λ¥Ό λ§μ΄ λ³΄μ•μ„ κ²ƒμ΄λ‹¤. **CAPCHAλ€?!** ν”„λ΅κ·Έλ¨μ„ μ‹¤ν–‰ν•λ” κ²ƒμ΄ μ‚¬λμΈμ§€ ν™•μΈν•κΈ° μ„ν•΄ μ»΄ν“¨ν„°λ” μ• μ μ—†λ” κΈ€μ”¨ λ“±μ„ ν™•μΈν•κ² ν•λ” κ²ƒμ΄λ‹¤. μ‚¬λμ΄ μ§μ ‘ν•μ§€ μ•μΌλ©΄ μ•λλ” μ¤‘μ”ν• κ²ƒ! ( ex) λΉ„λ°€λ²νΈ λ³€κ²½ )μ„ ν• λ• μ‚¬μ©ν•λ‹¤. 

νΉν, λΈλ¥΄ν¬ν¬μ¤ κ³µκ²©μ²λΌ ν”„λ΅κ·Έλ¨μ„ μ΄μ©ν•Έ κ³µκ²©μ— λ€μ‘ν•  λ• ν¨κ³Όμ μ΄λ‹¤.


> π’΅ ν•μ§€λ§ μ΄λ¥Ό μ λ€λ΅ κµ¬ν„ν•μ§€ μ•μΌλ©΄ ν•΄μ»¤λ” μ΄λ¥Ό **μ°ν**ν•μ—¬ κ³µκ²©ν•  μ μλ‹¤! (λ‘λ‘ν•κ²ƒλ“¤...)

![image](https://user-images.githubusercontent.com/53431568/125968793-7e09c6fc-51e0-4060-8f7f-da27ae25ea90.png)

λΉ„λ°€λ²νΈ λ³€κ²½μ„ μλ΅ λ“¤μ–΄λ³΄μ•λ‹¤. λ§μ•½ 1,2 κ°€ μ λ€λ΅ κµ¬ν„λμ§€ μ•μΌλ©΄ ν•΄μ»¤κ°€ CAPTCHAλ¥Ό ν™•μΈν• κ²ƒ μ²λΌ κΎΈλ―Έκ³  2λ²λ§ μ‹¤ν–‰ν•κ² ν•λ” κ²ƒμ΄λ‹¤.


μ•„μ‰½κ²λ„ μ‹¤μµλ¶€λ¶„μ€ κ°μ •(?)μ΄ λμ„ κ·Έλ°μ§€ DVWA μ‹¤μµμ΄ λ¶κ°€λ¥ν–λ‹¤ μ¤ν‚µν•λ‹¤ γ…γ… μ΄λ΅ λ§ μ•μ•„λ‘μ! π‘π‘

<br><br>

#### μ΄λ―Έμ§€ μ¶μ²
  
[https://edu.goorm.io/lecture/4953/ν™”μ΄νΈν•΄μ»¤κ°€-λκΈ°-μ„ν•-8κ°€μ§€-μ›Ή-ν•΄ν‚Ή-κΈ°μ ](https://edu.goorm.io/lecture/4953/ν™”μ΄νΈν•΄μ»¤κ°€-λκΈ°-μ„ν•-8κ°€μ§€-μ›Ή-ν•΄ν‚Ή-κΈ°μ )
  

