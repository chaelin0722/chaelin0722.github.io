---
title:  "[ë…¼ë¬¸ì •ë¦¬ğŸ“ƒ] Distract Your Attention: Multi-head Cross Attention Network for Facial Expression Recognition"
excerpt: "-DAN-"

categories:
  - fer
  
tags: [fer,CNN, paperReview]
use_math: true

last_modified_at: 2022-02-17T08:06:00-05:00
classes: wide
---

## Noisy Student Training using Body Language Dataset Improves Facial Expression Recognition
#### -DAN-

[ë…¼ë¬¸ì›ë³¸](https://arxiv.org/pdf/2109.07270.pdf)ğŸ˜™ 

ì´ë²ˆì—”, Papers with code ê¸°ì¤€, AffectNet Dataë¡œ í˜„ì¬ 2ìœ„ë¥¼ ì°¨ì§€í•˜ê³  ìˆëŠ” ë…¼ë¬¸ì„ ë¶„ì„í•´ë³´ê³ ì í•œë‹¤.

FERì— meta learning ê¸°ë²•ì„ ì ìš©í•˜ê³ ì ì—¬ëŸ¬ meta learning ê¸°ë²•ì„ ê³µë¶€í•˜ë˜ ì¤‘, ê¸°ì¡´ ë°©ì‹ë“¤ì€ ì™„ì „ ë‹¤ë¥´ê²Œ ìƒê¸´ ì´ë¯¸ì§€ì—ì„œ ê° í´ë˜ìŠ¤ ë‹¹ ì ì€ ë°ì´í„°ë§Œì„ ê°€ì§€ê³  ì—°ì‚°í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ ë°©ì‹ì„ ì œì‹œí•œë‹¤.

í•˜ì§€ë§Œ ì–¼êµ´ ë°ì´í„°ì˜ ê²½ìš°, ì–¼êµ´ì´ë¼ëŠ” ë²”ì£¼ëŠ” ê°™ê³ , ê·¸ ì•ˆì—ì„œ ë¯¸ì„¸í•œ í‘œì •ì°¨ì´ë§Œ ìˆê¸° ë•Œë¬¸ì— ê·¸ ì°¨ì´ì— ì´ˆì ì„ ë§ì¶”ë©´ì„œ ì•Œê³ ë¦¬ì¦˜ì„ ì–´ë–»ê²Œ ì ‘ê·¼í•´ì•¼í•  ì§€ì— ëŒ€í•´ ê³ ë¯¼í•˜ê³  ìˆë‹¤.

ê·¸ë˜ì„œ ì•½ê°„ ê±°ë¦¬ ê¸°ë°˜ì„ ì´ìš©í•˜ë©´ì„œ ì–¼êµ´ ë¶€ë¶„, ì¤‘ìš”í•œ í‘œì •ì´ ë³€í™”í•˜ëŠ” ê·¸ ë¶€ë¶„ì— ì´ˆì ì„ ë§ì¶˜ ë…¼ë¬¸ì„ ì°¾ì•„ì„œ ê³µë¶€í•´ ë³´ì•˜ë‹¤.


ë…¼ë¬¸ì—ì„œ ì œì‹œí•˜ê³  ìˆëŠ” ì „ì²´ ëª¨ë¸ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

![image](https://user-images.githubusercontent.com/53431568/154460463-ed3f5940-c778-4fd4-84c2-eeaaa0cabab3.png)

ì—¬ëŠ ëª¨ë¸ë“¤ê³¼ ë¹„ìŠ·í•˜ê²Œ base model (ì—¬ê¸°ì„œëŠ” resnet ì‚¬ìš©) ìœ¼ë¡œ featureì„ ì¶”ì¶œí•˜ì—¬ ê·¸ featureë¡œ attentionì„ ê±°ì³ì„œ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì´ë‹¤.

í¬ê²Œ FCN, MAN, AFN ì„¸ ëª¨ë“ˆë¡œ êµ¬ì„±ë˜ì–´ìˆë‹¤.

<br>

### - FCN(Feature Clustering Network)

![image](https://user-images.githubusercontent.com/53431568/154460989-53e5e913-5acf-4a51-ae61-659cbe001c0a.png)


<br>

#### Affinity Loss

ìˆ˜ì‹ì€ ì•„ë˜ì™€ ê°™ìœ¼ë©°, $M = Y$, ì—¬ê¸°ì„œ YëŠ” í´ë˜ìŠ¤(7ê°œ), ì´ë©° featureê°’ $x^'$ ì— ê° classì— í•´ë‹¹í•˜ëŠ” randomìœ¼ë¡œ ì •í•´ì§„ center pointì˜ ì°¨ì´ë¡œ lossë¥¼ êµ¬í•˜ê³  ìˆë‹¤.

![image](https://user-images.githubusercontent.com/53431568/154461199-8564a5c2-1e23-4dd0-bfb1-b979897bb296.png)


ì•„ë˜ëŠ” Affinity Loss ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ inter class ê°„ì˜ ê±°ë¦¬ë¥¼ ìµœëŒ€í™” ì‹œí‚¤ë©´ì„œ intra classì˜ ê±°ë¦¬ëŠ” ìµœì†Œí™” ì‹œí‚¤ëŠ” ì‹ìœ¼ë¡œ ë°ì´í„° ë¶„í¬ê°€ ì •ë¦¬ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

![image](https://user-images.githubusercontent.com/53431568/154461235-33a152c4-cebb-462a-9c9b-86078a4915f0.png)

<br>

### - MAN (Multi-head cross Attention Network)

Attention ëª¨ë“ˆì€ ì´ 2ê°€ì§€ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©° Spatial, Channel attentionì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤. ë‘ attentionì€ ì´ì „ ë…¼ë¬¸ì—ì„œë„ ë‹¤ë¤˜ëŠ”ë° ì´ë¦„ë§Œ ê°™ê³  ê·¸ ë‚´ìš©ì€ ë‹¤ë¥¸ ê²ƒ ê°™ë‹¤.

SAì™€ CA ë¥¼ ì‚¬ìš©í•œ ë…¼ë¬¸ì€ [[ë…¼ë¬¸ì •ë¦¬ğŸ“ƒ] Noisy Student Training using Body Language Dataset Improves Facial Expression Recognition](https://chaelin0722.github.io/fer/noisystudent/)
ì—¬ê¸°ë¥¼ ì°¸ê³ í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.


![image](https://user-images.githubusercontent.com/53431568/154462978-ddc7406a-bc65-4f8f-9a29-76405f1ef5b8.png)




![image](https://user-images.githubusercontent.com/53431568/154463215-a96d41cb-cb80-4dd4-839e-3f9b3198dfa3.png)


ì´ë²ˆ attention ì—ì„œëŠ” local featureì„ ë” ì˜ ë½‘ê¸° ìœ„í•´ì„œ 3x3, 1x3, 3x1 ì»¨ë³¼ë£¨ì…˜ì„ ê°ê° ê±°ì³ì„œ summation í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆë‹¤. ë‹¹ì—°í•œ ë§ì´ê² ì§€ë§Œ ì—¬ëŸ¬ ì‚¬ì´ì¦ˆì˜ kernelë¡œ convolutionì„ í•˜ê³  ë”í•˜ë©´
íŠ¹ì§• featureë“¤ì´ ë”í•´ì ¸ì„œ ì¤‘ìš” ë¶€ë¶„ì˜ ê°’ì´ ë” ì»¤ì§€ê¸° ë•Œë¬¸ì— ì§€ì—­ì  íŠ¹ì§•ì„ ì˜ í¬ì°©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.

ì´ í›„, spatial attentionì˜ output ê°’ì€ Channel Attentionì˜  input ê°’ìœ¼ë¡œ ë“¤ì–´ê°€ì„œ ë‘ë²ˆì˜ linearë¥¼ ê±°ì¹˜ê²Œ ëœë‹¤.



<br>

### - AFN (Attention Fusion Network)

![image](https://user-images.githubusercontent.com/53431568/154471553-268c347d-2d2a-49b1-9624-ed862a23abda.png)

MAN ëª¨ë“ˆì„ ê±°ì³ ë‚˜ì˜¨ í”¼ì³ë“¤ì„ ì‹œê·¸ëª¨ì´ë“œí•¨ìˆ˜ë¥¼ ìµœí•œ í›„ ê°ê° summationì„ í•´ì£¼ì–´  linear -> batch normalizationì„ ê±°ì³ì„œ ìµœì¢… featureë¥¼ ë½‘ê²Œ ëœë‹¤.


#### Partition Loss

AFN ì—ì„œ ì‚¬ìš©í•˜ëŠ” lossëŠ” ë‹¤ìŒê³¼ ê°™ì€ë°, ìœ„ì—ì„œ  attention ì´ k ë²ˆ ëŒì•„ê°€ë¯€ë¡œ ê·¸ê²ƒ ë§Œí¼ í‘œì¤€í¸ì°¨ë¡œ ë‚˜ëˆ„ì–´ì„œ log softmaxë¡œ ê³„ì‚°í•˜ê³  ìˆë‹¤.

![image](https://user-images.githubusercontent.com/53431568/154471570-6916a3e9-a6e7-4d91-824d-67762a7d9860.png)


ê²°êµ­ ìµœì¢… loss ëŠ” 3ê°€ì§€ lossë¥¼(affinity + partition + ce) ëª¨ë‘ í•©í•˜ì—¬ ì—…ë°ì´íŠ¸ í•˜ëŠ”ë°, ì•ì— íŒŒë¼ë¯¸í„°ë¥¼ ê³±í•´ì„œ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ì–´ ê³„ì‚°í•´ì¤€ë‹¤ (ë…¼ë¬¸ì—ì„œëŠ” 1.0 ìœ¼ë¡œ ì„¤ì •í•´ì¤Œ)

![image](https://user-images.githubusercontent.com/53431568/154471796-2174e83d-e97f-43ef-8475-f5911182d514.png)

<br>

### Performance

![image](https://user-images.githubusercontent.com/53431568/154471915-b0ec4b78-4547-482e-be05-121f956f1a67.png)


ì•„ë˜ ê·¸ë˜í”„ëŠ” attentionì„ ëª‡ë²ˆ ëŒë ¸ì„ ë•Œ ì„±ëŠ¥ì´ ì¢‹ì€ì§€ë¥¼ íŒë‹¨í•˜ê¸° ìœ„í•´ ê·¸ë¦° í‘œì´ë‹¤. 4ë²ˆì„ ë°˜ë³µí• ë•Œì˜ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ì•˜ê³ , ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì—ì„œëŠ” ê°ê° attentionì´ ëŒì•„ê°€ë©´ì„œ featureì„ visualizationí•œ ê²°ê³¼ì´ë‹¤.
ëˆˆê³¼ ì…ì£¼ë³€ì— ì¤‘ìš”ë„ê°€ ë¶„í¬ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![image](https://user-images.githubusercontent.com/53431568/154471951-5315476d-124b-44cc-a3ad-dc913e63fa49.png)

4ë²ˆë°˜ë³µí•˜ëŠ”ê²Œ ê°€ì¥ ì¢‹ì€ ì„±ëŠ¥ì´ë¼ëŠ”ë° ì–´ì°Œë³´ë©´ ë‹¹ì—°í•œ ê²°ê³¼ì¸ ê²ƒ ê°™ë‹¤ ì–‘ìª½ ëˆˆê³¼ ì–‘ìª½ ì…ê°€ê°€ í‘œì • ë³€í™”ì— ìˆì–´ì„œ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì´ì í´ë˜ìŠ¤ë“¤ì„ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ì§€í‘œì´ê¸° ë•Œë¬¸ì— ê²°ê³¼ê°€ ê·¸ë ‡ê²Œ ë‚˜ì˜¨ ê²ƒ ê°™ë‹¤.

ë§Œì•½ 3ë²ˆ ë°˜ë³µí–ˆë‹¤ë©´ ì…ìˆ ì´ë‚˜ ëˆˆ í•œìª½ì— ëŒ€í•œ ì§€í‘œê°€ ëˆ„ë½ë˜ì–´ìˆì„ í…ë°, í‘œì •ì˜ ëŒ€ì¹­ì´ ì¤‘ìš”í•˜ë¯€ë¡œ(ì˜ë¯¸ì‹¬ì¥í•œ í‘œì •ì„ ì§€ì„ ë•Œ í•œìª½ ëˆˆë§Œ ì»¤ì§€ê±°ë‚˜ ê·¸ëŸ¬ë©´ í•œìª½ ëˆˆì— ëŒ€í•´ì„œë§Œ ë¶„ë¥˜í•œë‹¤ë©´ ê²°ê³¼ëŠ” ë‹¤ë¥´ê²Œ ë‚˜ì˜¤ê² ì£ ?)
ì •í™•ë„ì˜ ì°¨ì´ê°€ í™•ì‹¤íˆ ë‚˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.




ì´ì œ ìŠ¬ìŠ¬ ì£¼ì œë¥¼ êµ¬ì²´í™” í•˜ê³  ì‹¤í—˜ì„ ê¹”ì§ê¹”ì§~ í•´ë³¼ ì‹œê¸°ê°€ ì™”ë‹¤.. ì¼ë‹¨ AFEW ë°ì´í„° ì…‹ì„ ì˜ ë¶„ì„í•´ë³´ë©´ì„œ Meta learning ê³µë¶€í•´ì•¼ê² ë‹¤. í™”ì´íŒ…!!ğŸ˜ğŸ˜



