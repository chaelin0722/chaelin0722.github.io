---
title:  "[í•™ìŠµ ì—ëŸ¬] RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same"
excerpt: ".to('cuda:0') or .to(device)"

categories:
  - etc

tags: [etc, pytorch, error, dnn]
classes: wide

last_modified_at: 2021-11-25T08:06:00-05:00
---

### RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same

mask-rcnn í•™ìŠµì„ ì‹œí‚¤ê³  ìˆëŠ”ë° ì „ì—ëŠ” ë©€ì©¡íˆ ì‹¤í–‰ë˜ë˜ ì½”ë“œê°€ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ë¥¼ ë¿œì–´ëƒˆë‹¤. ğŸ¤›ğŸ¤›

ì—´ì‹¬íˆ ì°¾ì•„ë³´ë‹ˆ í•´ê²°ë°©ë²•ì€ ë­.. Batch size ì¤„ì´ê¸°, sudo kill í•´ì„œ process ì£½ì´ê¸°.. ì´ë¯¸ í•´ë³¸ ë°©ë²•ë“¤ì´ë¼ ë‹¹í™©í•˜ê³  ìˆëŠ”ë°.. ë‹¤ì‹œ nvidia-smi ë¡œ ì‚´í´ë³¸ ê²°ê³¼

ì•„ë˜ process gpu ë¶€ë¶„ì—ëŠ” ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ê°€ ëœ¨ì§€ ì•Šì•„ì„œ ë‹¤ í”„ë¡œì„¸ìŠ¤ê°€ ì£½ì—ˆë‹¤ê³  ìƒê°í–ˆëŠ”ë° GPUì˜  Memory-Usage ë¶€ë¶„ì„ ë³´ë‹ˆ ìƒë‹¹ëŸ‰ì˜ ë©”ëª¨ë¦¬ê°€ ì°¨ì§€ë˜ê³  ìˆì—ˆë‹¤.

![image](https://user-images.githubusercontent.com/53431568/144225092-272d8135-607c-4abc-a2c7-58bfe683542c.png)



ì´ëŸ° ê²½ìš°ê°€ ì²˜ìŒì´ë¼ ë‹¹í™©í•˜ì˜€ì§€ë§Œ, ë‹¤ì‹œ ì—´ì‹¬íˆ memory-usageë¥¼ ì—†ì• ëŠ” ë°©ë²•ì„ ì°¾ìœ¼ë‹ˆ ë‚˜ì™”ë‹¤.. êµ¬ê¸€ë§ ë§Œì„¸! ë¸”ë¡œê±°ë“¤ ë§Œì„¸!

ì•Œì•„ë³´ë‹ˆ, ë¨¸ì‹ ëŸ¬ë‹ í•™ìŠµ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¤‘ê°„ì— ê°•ì œë¡œ ì¢…ë£Œë¥¼ í•´ë²„ë¦¬ë©´ ê°„í˜¹ í”„ë¡œì„¸ìŠ¤ê°€ ì™„ì „íˆ ì¢…ë£Œë˜ì§€ ì•Šê³  GPU ë©”ëª¨ë¦¬ì— ë°ì´í„°ê°€ ë‚¨ì•„ìˆëŠ” ê²½ìš°ê°€ ìˆë‹¤ê³  í•œë‹¤.

`ps aux | grep python` 

ìœ„ì˜ ëª…ë ¹ì–´ë¡œ ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ ì°¸ê³ 

![image](https://user-images.githubusercontent.com/53431568/144225431-928e85bf-dde8-48ac-9b72-6abea88d0d65.png)

ì •ë¦¬í•˜ìë©´,

~~~
### 10148 0.0 3.3 30865304 2761524 pts/0  Sl  17:59 0:01 /home/ì‹¤í–‰ì¤‘ì¸ íŒŒì¼ì˜ python ë””ë ‰í† ë¦¬ /home/ì‹¤í–‰ì¤‘ì¸ íŒŒì¼ì˜ ë””ë ‰í† ë¦¬ì™€ ëª…ë ¹ì–´
~~~

ì—¬ê¸°ì„œ ê°€ì¥ ì•ì— ë‚˜ì˜¨ 10148 ì´ PSID ì´ë‹¤. 

KILL í•˜ëŠ” ëª…ë ¹ì–´

~~~
sudo kill -9 PSID  

ë‚˜ì˜ ê²½ìš°,

sudo kill -9 10148
~~~

ì˜¤ëŠ˜ë„ ì—ëŸ¬ í•´ê²°~

<br>


#### ì°¸ê³ 

[1] [https://pulsar-kkaturi.tistory.com/](https://pulsar-kkaturi.tistory.com/entry/%EB%A6%AC%EB%88%85%EC%8A%A4-%ED%84%B0%EB%AF%B8%EB%84%90%EC%97%90%EC%84%9C-%EB%94%A5%EB%9F%AC%EB%8B%9D-%ED%95%99%EC%8A%B5-%EA%B0%95%EC%A0%9C-%EC%A4%91%EB%8B%A8%ED%96%88%EC%9D%84%EB%95%8C-GPU%EC%97%90-%EB%82%A8%EC%9D%80-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EC%A0%95%EB%A6%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95)
